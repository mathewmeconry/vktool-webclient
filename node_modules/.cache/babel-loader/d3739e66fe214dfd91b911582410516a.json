{"ast":null,"code":"import _classCallCheck from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/mathias/Documents/privat/VK/vk-tool/src/app/components/DataList.tsx\";\nimport React, { Component } from \"react\";\nimport { Page } from \"../components/Page\";\nimport Row from \"../components/Row\";\nimport Column from \"../components/Column\";\nimport Panel from \"../components/Panel\";\nimport Table from \"../components/Table\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport Loading from \"./Loading\";\nexport var DataList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(DataList, _Component);\n\n  function DataList(props) {\n    var _this;\n\n    _classCallCheck(this, DataList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DataList).call(this, props));\n\n    if (!_this.props.data.loading) {\n      setImmediate(function () {\n        _this.props.fetchData();\n      });\n    }\n\n    _this.elementView = _this.elementView.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.sortClick = _this.sortClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(DataList, [{\n    key: \"elementView\",\n    value: function elementView(event) {\n      if (event.currentTarget.parentNode && event.currentTarget.parentNode.parentNode && event.currentTarget.parentNode.parentNode.parentElement) {\n        var id = event.currentTarget.parentNode.parentNode.parentElement.getAttribute('data-key'); // open a new tap when the middle button is pressed (buttonID 1)\n\n        if (event.button == 1) {\n          window.open(document.location.origin + this.props.viewLocation + id);\n        } else {\n          this.props.history.push(this.props.viewLocation + id);\n        }\n      }\n    }\n  }, {\n    key: \"sortClick\",\n    value: function sortClick(event, sortKeys, sortDirection) {\n      this.props.onSort(sortKeys, sortDirection);\n    }\n  }, {\n    key: \"textSearch\",\n    value: function textSearch(event) {\n      this.props.onSearch(event.target.value);\n    }\n  }, {\n    key: \"renderTable\",\n    value: function renderTable() {\n      if (this.props.data.loading) {\n        return React.createElement(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60\n          },\n          __self: this\n        });\n      }\n\n      var dataById = {};\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.props.data.ids[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var id = _step.value;\n          dataById[id] = this.props.data.byId[id];\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return React.createElement(Table, {\n        columns: this.props.tableColumns.concat([{\n          text: 'Actions',\n          keys: ['_id'],\n          content: React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 72\n            },\n            __self: this\n          }, React.createElement(\"button\", {\n            className: \"btn btn-success view\",\n            onMouseUp: this.elementView,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 72\n            },\n            __self: this\n          }, React.createElement(FontAwesomeIcon, {\n            icon: \"eye\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 72\n            },\n            __self: this\n          })))\n        }]),\n        data: dataById,\n        sortClick: this.sortClick,\n        defaultSort: {\n          keys: this.props.data.sort.keys,\n          direction: this.props.data.sort.direction\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Page, {\n        title: this.props.title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, React.createElement(Column, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(Panel, {\n        title: React.createElement(\"input\", {\n          id: \"search\",\n          defaultValue: this.props.data.filter,\n          style: {\n            width: '200px'\n          },\n          placeholder: \"Search...\",\n          className: \"float-right form-control form-control-sm\",\n          onChange: function onChange(event) {\n            return _this2.textSearch(event);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, this.renderTable()))));\n    }\n  }]);\n\n  return DataList;\n}(Component);","map":{"version":3,"sources":["/home/mathias/Documents/privat/VK/vk-tool/src/app/components/DataList.tsx"],"names":["React","Component","Page","Row","Column","Panel","Table","FontAwesomeIcon","Loading","DataList","props","data","loading","setImmediate","fetchData","elementView","bind","sortClick","event","currentTarget","parentNode","parentElement","id","getAttribute","button","window","open","document","location","origin","viewLocation","history","push","sortKeys","sortDirection","onSort","onSearch","target","value","dataById","ids","byId","tableColumns","concat","text","keys","content","sort","direction","title","filter","width","textSearch","renderTable"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Page } from \"../components/Page\";\nimport Row from \"../components/Row\";\nimport Column from \"../components/Column\";\nimport Panel from \"../components/Panel\";\nimport { DataInterface } from \"../reducers/DataReducer\";\nimport Table, { TableColumn } from \"../components/Table\";\nimport { History } from \"history\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport Loading from \"./Loading\";\nimport StringIndexed from \"../interfaces/StringIndexed\";\n\nexport interface Props<T> {\n    data: DataInterface<T>,\n    fetchData: Function,\n    onSearch: Function,\n    onSort: Function,\n    title: string,\n    viewLocation: string,\n    tableColumns: Array<TableColumn>\n    history: History\n}\n\nexport class DataList<T> extends Component<Props<T>> {\n    constructor(props: Props<T>) {\n        super(props)\n\n        if (!this.props.data.loading) {\n            setImmediate(() => { this.props.fetchData() })\n        }\n\n        this.elementView = this.elementView.bind(this)\n        this.sortClick = this.sortClick.bind(this)\n    }\n\n    public elementView(event: React.MouseEvent<HTMLButtonElement>) {\n        if (event.currentTarget.parentNode && event.currentTarget.parentNode.parentNode && event.currentTarget.parentNode.parentNode.parentElement) {\n            let id = event.currentTarget.parentNode.parentNode.parentElement.getAttribute('data-key')\n\n            // open a new tap when the middle button is pressed (buttonID 1)\n            if (event.button == 1) {\n                window.open((document.location as Location).origin + this.props.viewLocation + id)\n            } else {\n                this.props.history.push(this.props.viewLocation + id)\n            }\n        }\n    }\n\n    private sortClick(event: React.MouseEvent<HTMLTableHeaderCellElement>, sortKeys: Array<string>, sortDirection: 'asc' | 'desc') {\n        this.props.onSort(sortKeys, sortDirection)\n    }\n\n    private textSearch(event: React.ChangeEvent<HTMLInputElement>) {\n        this.props.onSearch(event.target.value)\n    }\n\n    private renderTable() {\n        if (this.props.data.loading) {\n            return (\n                <Loading />\n            )\n        }\n\n        let dataById: StringIndexed<any> = {}\n        for(let id of this.props.data.ids) {\n            dataById[id] = this.props.data.byId[id]\n        }\n\n        return (\n            <Table<T>\n                columns={this.props.tableColumns.concat([\n                    { text: 'Actions', keys: ['_id'], content: <div><button className=\"btn btn-success view\" onMouseUp={this.elementView}><FontAwesomeIcon icon=\"eye\" /></button></div> }\n                ])}\n                data={dataById}\n                sortClick={this.sortClick}\n                defaultSort={{ keys: this.props.data.sort.keys, direction: this.props.data.sort.direction }}\n            />\n        )\n    }\n\n    public render() {\n        return (\n            <Page title={this.props.title}>\n                <Row>\n                    <Column>\n                        <Panel title={<input id=\"search\" defaultValue={this.props.data.filter} style={{ width: '200px' }} placeholder=\"Search...\" className=\"float-right form-control form-control-sm\" onChange={(event) => this.textSearch(event)} />}>\n                            {this.renderTable()}\n                        </Panel>\n                    </Column>\n                </Row>\n            </Page>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}