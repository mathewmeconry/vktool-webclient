{"ast":null,"code":"import _classCallCheck from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/mathias/Documents/privat/VK/vk-tool/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/mathias/Documents/privat/VK/vk-tool/src/app/views/AddBillingReport.tsx\";\n//@ts-ignore\nimport StepWizard from 'react-step-wizard';\nimport React, { Component } from 'react';\nimport { Page } from '../components/Page';\nimport Row from '../components/Row';\nimport Column from '../components/Column';\nimport Panel from '../components/Panel';\nimport { Data } from '../actions/DataActions';\nimport { connect } from 'react-redux';\nimport WizardNav from '../components/WizardNav';\nimport AddBillingReportStep1 from './AddBillingReportSteps/AddBillingReportStep1';\nimport AddBillingReportStep2 from './AddBillingReportSteps/AddBillingReportStep2';\nimport AddBillingReportStep3 from './AddBillingReportSteps/AddBillingReportStep3';\nimport AddBillingReportStep4 from './AddBillingReportSteps/AddBillingReportStep4';\nimport Loading from '../components/Loading';\nexport var _AddBillingReport =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(_AddBillingReport, _Component);\n\n  function _AddBillingReport(props) {\n    var _this;\n\n    _classCallCheck(this, _AddBillingReport);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(_AddBillingReport).call(this, props));\n    _this.onNext = _this.onNext.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.save = _this.save.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    setImmediate(function () {\n      _this.props.fetchOpenOrders();\n\n      _this.props.fetchMembers();\n    }); // init it with forced nulls\n    //@ts-ignore\n\n    _this.state = {};\n    return _this;\n  }\n\n  _createClass(_AddBillingReport, [{\n    key: \"onNext\",\n    value: function onNext(data) {\n      var state = this.state;\n\n      for (var i in data) {\n        state[i] = data[i];\n      }\n\n      this.setState(state);\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var compensationEntries = {};\n\n      for (var i in this.state.vks) {\n        //@ts-ignore\n        compensationEntries[i] = this.state.vks[i];\n        compensationEntries[i].member = this.state.vks[i].member._id;\n      }\n\n      this.props.save({\n        orderId: this.state.order._id,\n        date: this.state.date,\n        compensationEntries: this.state.vks,\n        food: this.state.food,\n        remarks: this.state.remarks,\n        creatorId: this.props.user._id\n      });\n      this.props.history.push('/billing-reports');\n      return true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.props.loading) {\n        return React.createElement(Page, {\n          title: \"Verrechnungsrapport erfassen\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        }, React.createElement(Loading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(Page, {\n        title: \"Verrechnungsrapport erfassen\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(Column, {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(Panel, {\n        title: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, React.createElement(StepWizard, {\n        nav: React.createElement(WizardNav, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(AddBillingReportStep1, {\n        openOrders: this.props.openOrders,\n        onNext: this.onNext,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }), React.createElement(AddBillingReportStep2, {\n        members: this.props.members,\n        onNext: this.onNext,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }), React.createElement(AddBillingReportStep3, {\n        onNext: this.onNext,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }), React.createElement(AddBillingReportStep4, {\n        onNext: this.save,\n        order: this.state.order,\n        date: this.state.date,\n        vks: this.state.vks,\n        food: this.state.food,\n        remarks: this.state.remarks,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }))))));\n    }\n  }]);\n\n  return _AddBillingReport;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.data.user.data,\n    openOrders: state.data.openOrders,\n    members: state.data.members,\n    loading: state.data.openOrders.loading || state.data.members.loading || state.data.user.loading || !state.data.openOrders.ids || !state.data.members.ids || Object.keys(state.data.user.data).length < 0\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    fetchOpenOrders: function fetchOpenOrders() {\n      dispatch(Data.fetchOpenOrders());\n    },\n    fetchMembers: function fetchMembers() {\n      dispatch(Data.fetchMembers());\n    },\n    save: function save(data) {\n      dispatch(Data.addBillingReport(data));\n    }\n  };\n}; //@ts-ignore\n\n\nexport var AddBillingReport = connect(mapStateToProps, mapDispatchToProps)(_AddBillingReport);","map":{"version":3,"sources":["/home/mathias/Documents/privat/VK/vk-tool/src/app/views/AddBillingReport.tsx"],"names":["StepWizard","React","Component","Page","Row","Column","Panel","Data","connect","WizardNav","AddBillingReportStep1","AddBillingReportStep2","AddBillingReportStep3","AddBillingReportStep4","Loading","_AddBillingReport","props","onNext","bind","save","setImmediate","fetchOpenOrders","fetchMembers","state","data","i","setState","compensationEntries","vks","member","_id","orderId","order","date","food","remarks","creatorId","user","history","push","loading","openOrders","members","mapStateToProps","ids","Object","keys","length","mapDispatchToProps","dispatch","addBillingReport","AddBillingReport"],"mappings":"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","sourcesContent":["//@ts-ignore\nimport StepWizard from 'react-step-wizard';\nimport React, { Component } from 'react';\nimport { Page } from '../components/Page';\nimport Row from '../components/Row';\nimport Column from '../components/Column';\nimport Panel from '../components/Panel';\nimport { State } from '../reducers/IndexReducer';\nimport { ThunkDispatch } from 'redux-thunk';\nimport { AnyAction } from 'redux';\nimport { Data } from '../actions/DataActions';\nimport { connect } from 'react-redux';\nimport { DataInterface } from '../reducers/DataReducer';\nimport OrderModel from '../../shared/models/OrderModel';\nimport ContactModel from '../../shared/models/ContactModel';\nimport WizardNav from '../components/WizardNav';\nimport AddBillingReportStep1 from './AddBillingReportSteps/AddBillingReportStep1';\nimport AddBillingReportStep2 from './AddBillingReportSteps/AddBillingReportStep2';\nimport AddBillingReportStep3 from './AddBillingReportSteps/AddBillingReportStep3';\nimport AddBillingReportStep4 from './AddBillingReportSteps/AddBillingReportStep4';\nimport StringIndexed from '../interfaces/StringIndexed';\nimport { BillingReportCompensationEntry, PutBillingReport } from '../interfaces/BillingReport';\nimport { History } from \"history\";\nimport Loading from '../components/Loading';\nimport UserModel from '../../shared/models/UserModel';\n\nexport interface AddBillingReportProps {\n    user: UserModel,\n    openOrders: DataInterface<OrderModel>,\n    members: DataInterface<ContactModel>,\n    loading: boolean,\n    fetchOpenOrders: Function,\n    fetchMembers: Function,\n    save: (data: PutBillingReport) => void,\n    history: History\n}\n\ninterface AddBillingReportState {\n    order: OrderModel,\n    date: Date,\n    vks: StringIndexed<BillingReportCompensationEntry>,\n    food: boolean,\n    remarks: string,\n    [index: string]: any\n}\n\nexport class _AddBillingReport extends Component<AddBillingReportProps, AddBillingReportState> {\n    constructor(props: AddBillingReportProps) {\n        super(props)\n\n        this.onNext = this.onNext.bind(this)\n        this.save = this.save.bind(this)\n\n        setImmediate(() => {\n            this.props.fetchOpenOrders()\n            this.props.fetchMembers()\n        })\n\n        // init it with forced nulls\n        //@ts-ignore\n        this.state = {}\n    }\n\n    private onNext(data: StringIndexed<any>): void {\n        let state: AddBillingReportState = this.state\n        for (let i in data) {\n            state[i] = data[i]\n        }\n\n        this.setState(state)\n    }\n\n    private save(): boolean {\n        let compensationEntries: StringIndexed<BillingReportCompensationEntry<string>> = {}\n\n        for (let i in this.state.vks) {\n            //@ts-ignore\n            compensationEntries[i] = this.state.vks[i]\n            compensationEntries[i].member = this.state.vks[i].member._id\n        }\n\n        this.props.save({\n            orderId: this.state.order._id,\n            date: this.state.date,\n            compensationEntries: this.state.vks,\n            food: this.state.food,\n            remarks: this.state.remarks,\n            creatorId: this.props.user._id\n        })\n\n        this.props.history.push('/billing-reports')\n\n        return true\n    }\n\n    public render() {\n        if (this.props.loading) {\n            return (\n                <Page title=\"Verrechnungsrapport erfassen\">\n                    <Loading />\n                </Page>\n            )\n        }\n\n        return (\n            <Page title=\"Verrechnungsrapport erfassen\">\n                <Row>\n                    <Column className=\"col\">\n                        <Panel title=\"\">\n                            <StepWizard nav={<WizardNav />}>\n                                <AddBillingReportStep1 openOrders={this.props.openOrders} onNext={this.onNext} />\n                                <AddBillingReportStep2 members={this.props.members} onNext={this.onNext} />\n                                <AddBillingReportStep3 onNext={this.onNext} />\n                                <AddBillingReportStep4\n                                    onNext={this.save}\n                                    order={this.state.order}\n                                    date={this.state.date}\n                                    vks={this.state.vks}\n                                    food={this.state.food}\n                                    remarks={this.state.remarks}\n                                />\n                            </StepWizard>\n                        </Panel>\n                    </Column>\n                </Row>\n            </Page>\n        )\n    }\n}\n\nconst mapStateToProps = (state: State) => {\n    return {\n        user: state.data.user.data,\n        openOrders: state.data.openOrders,\n        members: state.data.members,\n        loading: state.data.openOrders.loading ||\n            state.data.members.loading ||\n            state.data.user.loading ||\n            !state.data.openOrders.ids ||\n            !state.data.members.ids ||\n            Object.keys(state.data.user.data as UserModel).length < 0\n    }\n}\n\nconst mapDispatchToProps = (dispatch: ThunkDispatch<State, undefined, AnyAction>) => {\n    return {\n        fetchOpenOrders: () => {\n            dispatch(Data.fetchOpenOrders())\n        },\n        fetchMembers: () => {\n            dispatch(Data.fetchMembers())\n        },\n        save: (data: PutBillingReport) => {\n            dispatch(Data.addBillingReport(data))\n        }\n    }\n}\n\n//@ts-ignore\nexport const AddBillingReport = connect(mapStateToProps, mapDispatchToProps)(_AddBillingReport)"]},"metadata":{},"sourceType":"module"}